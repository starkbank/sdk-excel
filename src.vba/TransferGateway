
Public Function getStatus(Status As String)
    Select Case Status
        Case "Todos": getStatus = "all"
        Case "Sucesso":  getStatus = "success"
        Case "Processando":  getStatus = "processing"
        Case "Falha":  getStatus = "failed"
    End Select
    
End Function

Public Function getStatusInPt(Status As String)
    Select Case Status
        Case "success":  getStatusInPt = "sucesso"
        Case "processing":  getStatusInPt = "processando"
        Case "failed":  getStatusInPt = "falha"
        Case "unknown":  getStatusInPt = "desconhecido"
        Case "canceled": getStatusInPt = "cancelado"
    End Select
    
End Function

Public Function Transfer(amount As Long, taxId As String, name As String, bankCode As String, branchCode As String, accountNumber As String, tags() As String) As Dictionary
    Dim dict As New Dictionary
    
    
    dict.Add "amount", amount
    dict.Add "taxId", taxId
    dict.Add "name", name
    dict.Add "bankCode", bankCode
    dict.Add "branchCode", branchCode
    dict.Add "accountNumber", accountNumber
    dict.Add "tags", tags
    
    Set Transfer = dict
    
End Function

Public Function getTransfers(cursor As String, optionalParam As Dictionary)
    Dim query As String
    Dim resp As Response
    
    
    query = ""
    If cursor <> "" Then
        query = "?cursor=" + cursor
    End If
    
    If optionalParam.Count > 0 Then
        For Each Key In optionalParam
            If query = "" Then
                query = "?" + Key + "=" + CStr(optionalParam(Key))
            Else
                query = query + "&" + Key + "=" + CStr(optionalParam(Key))
            End If
        Next
    End If
    
    Set resp = Rest.getRequest("/v2-faks/transfer", query, New Dictionary)
    
    If resp.Status >= 300 Then
        MsgBox resp.errors()("errors")(1)("message"), , "Erro"
    End If
    
    Set getTransfers = resp.json()
    
End Function

Public Function getTransferLogs(cursor As String, optionalParam As Dictionary)
    Dim query As String
    Dim resp As Response
    
    
    query = ""
    If cursor <> "" Then
        query = "?cursor=" + cursor
    End If
    
    If optionalParam.Count > 0 Then
        For Each Key In optionalParam
            If query = "" Then
                query = "?" + Key + "=" + CStr(optionalParam(Key))
            Else
                query = query + "&" + Key + "=" + CStr(optionalParam(Key))
            End If
        Next
    End If
    
    Set resp = Rest.getRequest("/v2-faks/transfer/log", query, New Dictionary)
    
    If resp.Status >= 300 Then
        MsgBox resp.errors()("errors")(1)("message"), , "Erro"
    End If
    
    Set getTransferLogs = resp.json()
    
End Function

Public Function getAccountTypePT(accountType As Variant) As String
    Select Case LCase(accountType)
        Case "checking":  getAccountTypePT = "corrente"
        Case "savings":  getAccountTypePT = "poupança"
        Case "payment":  getAccountTypePT = "pagamento"
        Case "salary":  getAccountTypPTe = "salário"
        Case Else:  getAccountTypePT = accountType
    End Select
    
End Function
