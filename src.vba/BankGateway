
Public Function getTransaction(cursor As String, optionalParam As Dictionary)
    Dim query As String
    Dim resp As Response
    
    
    query = ""
    If cursor <> "" Then
        query = "?cursor=" + cursor
    End If
    
    If optionalParam.Count > 0 Then
        For Each Key In optionalParam
            If query = "" Then
                query = "?" + Key + "=" + CStr(optionalParam(Key))
            Else
                query = query + "&" + Key + "=" + CStr(optionalParam(Key))
            End If
            
        Next
    End If
    
    Set resp = Rest.getRequest("/v2-faks/transaction", query, New Dictionary)
    
    If resp.Status >= 300 Then
        MsgBox resp.errors()("errors")(1)("message"), , "Erro"
    End If
    
    Set getTransaction = resp.json()

End Function

Public Function getAccount()
    Dim resp As Response
    
    
    Set resp = Rest.getRequest("/v2-faks/balance/", "", New Dictionary)
    
    Set getAccount = resp.json()
    If resp.Status <> 200 Then
        If resp.errors()("errors")(1)("code") <> "invalidSession" Then
            MsgBox resp.errors()("errors")(1)("message"), , "Erro"
        End If
        Set getAccount = New Dictionary
    End If

End Function
