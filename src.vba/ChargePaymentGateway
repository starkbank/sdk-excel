
Public Function getStatus(Status As String)
    Select Case Status
        Case "Todos": getStatus = "all"
        Case "Criados":  getStatus = "created"
        Case "Cancelados":  getStatus = "canceled"
        Case "Processando":  getStatus = "processing"
        Case "Pagos":  getStatus = "success"
        Case "Falha":  getStatus = "failed"
    End Select
    
End Function

Public Function getStatusInPt(Status As String)
    Select Case Status
        Case "created":  getStatusInPt = "criado"
        Case "canceled":  getStatusInPt = "cancelado"
        Case "processing":  getStatusInPt = "processando"
        Case "success":  getStatusInPt = "pago"
        Case "failed":  getStatusInPt = "falha"
        Case "unknown":  getStatusInPt = "desconhecido"
    End Select
    
End Function

Public Function getChargePayments(cursor As String, optionalParam As Dictionary)
    Dim query As String
    Dim resp As Response
    
    
    query = ""
    If cursor <> "" Then
        query = "?cursor=" + cursor
    End If
    
    If optionalParam.Count > 0 Then
        For Each Key In optionalParam
            If query = "" Then
                query = "?" + Key + "=" + CStr(optionalParam(Key))
            Else
                query = query + "&" + Key + "=" + CStr(optionalParam(Key))
            End If
            
        Next
    End If

    Set resp = Rest.getRequest("/v2-faks/boleto-payment", query, New Dictionary)
     
    If resp.Status >= 300 Then
        MsgBox resp.errors()("errors")(1)("message"), vbExclamation, "Erro"
    End If
    
    Set getChargePayments = resp.json()

End Function
