
Public Function generatePrivateKeySecret()
    Dim file As String
    Dim result As String
    Dim path As String: path = Environ("StarkBankExcelEcdsa")


    file = path + "\Starkbank-excel-ecdsa.exe"
    result = ShellRun("""" + file + """ generatePrivateKeySecret """ + """")
    
    generatePrivateKeySecret = result
    
End Function

Public Function getPublicKeyFromSecret(secret As String)
    Dim file As String
    Dim result As String
    Dim path As String: path = Environ("StarkBankExcelEcdsa")


    file = path + "\Starkbank-excel-ecdsa.exe"
    getPublicKeyFromSecret = ShellRun("""" + file + """ getPublicKeyFromSecret """ + secret + """")

End Function

Public Function getSecretFromString(secretString As String)
    Dim file As String
    Dim result As String
    Dim path As String: path = Environ("StarkBankExcelEcdsa")


    file = path + "\Starkbank-excel-ecdsa.exe"
    getSecretFromString = ShellRun("""" + file + """ getSecretFromString """ + secretString + """")

End Function

Public Function sign(message As String, secret As String)
    Dim treatedMessage As String
    Dim file As String
    Dim result As String
    Dim path As String: path = Environ("StarkBankExcelEcdsa")

    treatedMessage = Replace(message, """", "\""")
    file = path + "\Starkbank-excel-ecdsa.exe"
    sign = ShellRun("""" + file + """ sign  """ + treatedMessage + """" + " " + """" + secret + """")
    
End Function